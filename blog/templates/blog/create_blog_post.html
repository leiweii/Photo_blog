{% extends 'base.html' %}
{% block content %}
  <h2>ðŸ“– Ã‰crire un blog</h2>

  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}

    {{ blog_form.as_p }}
    {{ photo_form.as_p }}

    <!-- AperÃ§u dynamique de la photo uploadÃ©e -->
    <div class="mb-3">
      <label><strong>AperÃ§u de la photo :</strong></label><br>
      <img id="photo-preview" src="#" alt="AperÃ§u" style="max-width: 300px; display: none;" />
    </div>

    <button type="submit" class="btn btn-primary">Publier</button>
  </form>

  <!-- Script JS pour affichage dynamique -->
  <script>
    const input = document.querySelector('input[type="file"]');
    const preview = document.getElementById('photo-preview');

    input.addEventListener('change', function () {
      const file = this.files[0];
      if (file) {
        const reader = new FileReader();
        preview.style.display = 'block';

        reader.addEventListener("load", function () {
          preview.setAttribute("src", this.result);
        });

        reader.readAsDataURL(file);
      } else {
        preview.style.display = 'none';
        preview.removeAttribute("src");
      }
    });
  </script>
{% endblock content %}
